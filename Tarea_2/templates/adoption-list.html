{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/adoption-list.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/adoption-form.css') }}">
{% endblock %}

{% block title %}Adoptar{% endblock %}

{% block content %}
{% if error %}
<div class="mensaje-error" style="background-color: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
    {{ error }}
</div>
{% endif %}

<!-- Contenedor de listado -->
<div class="listado-casilla">
    <div class="listado">
        <!-- Encabezados -->
        <div class="listado-header">
            <div class="listado-cabeza">Fecha Publicación</div>
            <div class="listado-cabeza">Fecha Entrega</div>
            <div class="listado-cabeza">Comuna</div>
            <div class="listado-cabeza">Sector</div>
            <div class="listado-cabeza">Cantidad / Tipo / Edad</div>
            <div class="listado-cabeza">Nombre Contacto</div>
            <div class="listado-cabeza">Total Fotos</div>
        </div>
        <!-- Filas desde la base de datos -->
        <div class="listado-body">
            {% for aviso in avisos %}
            <div class="listado-fila" data-aviso-id="{{ aviso.id }}" style="cursor: pointer;">
                <div class="listado-celda">{{ aviso.fecha_ingreso.strftime('%Y-%m-%d %H:%M') if aviso.fecha_ingreso else 'N/A' }}</div>
                <div class="listado-celda">{{ aviso.fecha_entrega.strftime('%Y-%m-%d %H:%M') if aviso.fecha_entrega else 'N/A' }}</div>
                <div class="listado-celda">{{ aviso.comuna }}</div>
                <div class="listado-celda">{{ aviso.sector or 'No especificado' }}</div>
                <div class="listado-celda">{{ aviso.cantidad }} {{ aviso.tipo }}(s) / {{ aviso.edad }} {{ 'años' if aviso.unidad_medida == 'a' else 'meses' }}</div>
                <div class="listado-celda">{{ aviso.nombre_contacto }}</div>
                <div class="listado-celda">{{ aviso.total_fotos }}</div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Paginación -->
    <div class="paginacion" style="text-align: center; margin-top: 20px;">
        {% if page > 1 %}
        <a href="{{ url_for('adoption_list', page=page-1) }}" style="padding: 10px 15px; margin: 0 5px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">← Anterior</a>
        {% endif %}

        <span style="padding: 10px 15px; margin: 0 5px;">Página {{ page }} de {{ total_pages }}</span>

        {% if page < total_pages %}
        <a href="{{ url_for('adoption_list', page=page+1) }}" style="padding: 10px 15px; margin: 0 5px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">Siguiente →</a>
        {% endif %}
    </div>
</div>

<!-- Contenedor detalle -->
<div id="detalle-container" style="display:none;">
    <h2>Detalle del Aviso</h2>
    <div id="detalle-info"></div>
    <div id="detalle-fotos"></div>
    <button id="volver-listado">Volver al listado</button>
    <button id="volver-portada">Volver a la portada</button>
</div>

<!-- Contenedor para foto clickeada -->
<div id="foto-clickeada" style="display:none;">
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', filename='scripts/javascript/adoption-list.js') }}"></script>
{% endblock %}